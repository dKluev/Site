var ddpowerzoomer={dsetting:{defaultpower:2,powerrange:[2,7],magnifiersize:[75,75]},mousewheelevt:/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",$magnifier:{outer:null,inner:null,image:null},activeimage:null,movemagnifier:function(e,t,n){var r=ddpowerzoomer.activeimage;var i=r.info;var s=i.coords;var o=ddpowerzoomer.$magnifier;var u=i.magdimensions;var a=i.power.current;var f=i.power.range;var l=e.pageX-s.left;var c=e.pageY-s.top;if(t==true){if(e.pageX>=s.left&&e.pageX<=s.right&&e.pageY>=s.top&&e.pageY<=s.bottom)o.outer.css({left:e.pageX-u[0]/2,top:e.pageY-u[1]/2});else{ddpowerzoomer.activeimage=null;o.outer.hide()}}else if(n){var h=i.dimensions;var p=n=="in"?Math.min(a+1,f[1]):Math.max(a-1,f[0]);var d=[h[0]*p,h[1]*p];o.image.css({width:d[0],height:d[1]});i.power.current=p}a=i.power.current;var v=-l*a+u[0]/2;var m=-c*a+u[1]/2;o.inner.css({left:v,top:m})},setupimage:function(e,t,n){var r=jQuery.extend({},ddpowerzoomer.dsetting,n);var i=e(t);t.info={power:{current:r.defaultpower,range:r.powerrange},magdimensions:r.magnifiersize,dimensions:[i.width(),i.height()],coords:null};i.unbind("mouseenter").mouseenter(function(e){var o=ddpowerzoomer.$magnifier;o.outer.css({width:r.magnifiersize[0],height:r.magnifiersize[1]});var u=i.offset();var a=t.info.power.current;o.inner.html('<img src="'+n.largeimagesrc+'"/>');o.image=o.outer.find("img:first").css({width:t.info.dimensions[0]*a,height:t.info.dimensions[1]*a});var f={left:u.left,top:u.top,right:u.left+t.info.dimensions[0],bottom:u.top+t.info.dimensions[1]};t.info.coords=f;o.outer.show();ddpowerzoomer.activeimage=t})},init:function(e){var t=e('<div style="z-index:8050;position:absolute;width:100px;height:100px;display:none;overflow:hidden;border:1px solid black;" />').append('<div style="position:relative;left:0;top:0;" />').appendTo(document.body);ddpowerzoomer.$magnifier={outer:t,inner:t.find("div:eq(0)"),image:null};t=ddpowerzoomer.$magnifier;e(document).unbind("mousemove.trackmagnifier").bind("mousemove.trackmagnifier",function(e){if(ddpowerzoomer.activeimage){ddpowerzoomer.movemagnifier(e,true)}})}};jQuery.fn.addpowerzoom=function(e){var t=jQuery;return this.each(function(){if(this.tagName!="IMG")return true;if(typeof e=="undefined")e={};if(e.largeimage&&e.largeimage.length>0){e.preloadimg=new Image;e.preloadimg.src=e.largeimage}var n=t(this);e.largeimagesrc=e.preloadimg?e.preloadimg.src:n.attr("src");if(parseInt(this.style.width)>0&&parseInt(this.style.height)>0)ddpowerzoomer.setupimage(t,this,e);else if(this.complete){ddpowerzoomer.setupimage(t,this,e)}else{n.bind("load",function(){ddpowerzoomer.setupimage(t,this,e)})}})};jQuery(document).ready(function(e){ddpowerzoomer.init(e)})
